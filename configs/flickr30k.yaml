log_tag: "flickr30k-preextracted"
seed: 42

dataset:
  train_path: /data/SSD/flickr30k/annotations/train.json
  val_path: /data/SSD/flickr30k/annotations/val.json
  test_path: /data/SSD/flickr30k/annotations/test.json
  img_path: /data/SSD/flickr30k/images
  img_path_test: /data/SSD/flickr30k/images
  log_path: res
  ratio: 1
  pre_extract: False

model:
  num_dim: 512
  use_residual: False

train:
  # Basic
  max_epochs: 50 # Normally 6 for fine-tuning, 30 for training from scratch
  lr: 1e-6
  weight_decay: 5e-2
  betas: [0.9, 0.999]
  # Scheduler
  T_max: 40
  lr_min: 1e-9
  # Dataset
  batch_size: 1024
  num_workers: 8
  log_interval: 10
  # Label update warm-up

train_2:
  # For K-means
  initial_n_clusters: 10 # N - initial_n_clusters
  first_stage_n: 50 # Decay using sigmoid till this number of clusters
  second_stage_n: 5 # Decay * 0.8 till this number of clusters
  k_means_start_epoch: 10 # Start K-means from this epoch
  k_means_slow_epoch: 40 # Slow down K-means decay from this epoch

eval:
  batch_size: 1024
  num_workers: 8
  max_clusters: 100

control:
  train: True # Network
  train_2: True # K-means
  val: True # Test label embedding in the training set
  test: True # Test label embedding in the test set
  save: False
  save_interval: 1
